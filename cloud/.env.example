# Cloud environment variables
#
# This file is consumed by:
# - cloud/compose.release.yml (production)
# - cloud/compose.sandbox.yml (parallel testing on same VPS)

# GitHub Container Registry owner/namespace.
#
# Why this exists:
# - Lets you pull images from a "test" namespace (fork / new repo) without editing compose files.
# - Makes it easy to move personal -> GitHub org later.
GHCR_OWNER=YOUR_GITHUB_USERNAME

# For continuous deploy, set to a pushed tag like: sha-<gitsha> or main
CLOUD_TAG=main

# Existing VictoriaMetrics data volume name.
# Must already exist when using external volumes (see compose files).
CLOUD_VM_VOLUME_NAME=vmdata

# Required: pin 3rd party images (avoid :latest)
#
# Recommended: pin by digest from a known-good server:
#   victoriametrics/victoria-metrics@sha256:<digest>
#
# Helper (from repo root on a server running the stack):
#   ./scripts/pin_third_party_images.sh cloud cloud/compose.dev.yml
VM_IMAGE=
GRAFANA_IMAGE=

# Optional (already not :latest, but you may pin by digest if you want):
CADDY_IMAGE=caddy:2

# Sandbox (compose.sandbox.yml) bind address for exposed high ports.
#
# Default keeps sandbox services accessible only from the VPS itself (SSH tunnel recommended).
# Set to 0.0.0.0 to expose publicly (then protect with firewall / Cloudflare / allowlist).
SANDBOX_BIND=127.0.0.1

# Domain + TLS
BASE_DOMAIN=example.com
ACME_EMAIL=admin@example.com

# Grafana admin user (password is read from /etc/ovr/secrets/grafana_admin_password)
GRAFANA_ADMIN_USER=admin

# VictoriaMetrics write auth (used by Caddy basic_auth)
VM_WRITE_USER=ovr
# Generate with: docker compose run --rm caddy caddy hash-password --plaintext 'your_password'
VM_WRITE_PASS_HASH=$2a$14$replace_with_hash

# Optional: load the bcrypt hash from a file on the server
VM_WRITE_PASS_HASH_FILE=/etc/ovr/secrets/vm_write_password_hash

# Optional retention override
VM_RETENTION=365d

# Fleet map config (optional)
# Use :avg if you're stream-aggregating; set blank to use raw metrics.
FLEET_METRIC_SUFFIX=:avg
FLEET_DEPLOYMENT_ID=
FLEET_LOOKBACK_SECONDS=3600
FLEET_GPS_STALE_SECONDS=1800

# Node UI links (set one of the following)
# Option A: full template
FLEET_NODE_URL_TEMPLATE=
# Option B: domain/subdomain synthesis
FLEET_NODE_DOMAIN=
FLEET_NODE_SUBDOMAIN=node

# Edge report uploads
FLEET_REPORTS_UPLOAD_TOKEN=
FLEET_REPORTS_PATH=/data/reports
FLEET_REPORTS_TIMEZONE=America/Los_Angeles

# Cloudflare Access (optional)
# Set FLEET_ACCESS_AUD and one of FLEET_ACCESS_TEAM_DOMAIN or FLEET_ACCESS_CERTS_URL to enable.
FLEET_ACCESS_AUD=
FLEET_ACCESS_TEAM_DOMAIN=
FLEET_ACCESS_CERTS_URL=
FLEET_ACCESS_JWT_HEADER=Cf-Access-Jwt-Assertion
FLEET_ACCESS_ISSUER=
FLEET_ACCESS_JWKS_TTL=3600
FLEET_ACCESS_JWT_LEEWAY=60
FLEET_ACCESS_BYPASS_PATHS=/api/health,/api/reports/upload

# Map tile providers + guardrails
MAP_DEFAULT_PROVIDER=esri
MAPBOX_TOKEN=
MAPBOX_TOKEN_FILE=
ESRI_TOKEN=
MAPBOX_FREE_TILES_PER_MONTH=750000
ESRI_FREE_TILES_PER_MONTH=2000000
GUARDRAIL_LIMIT_PCT=0.95
FLEET_MAP_TILES_LOOKBACK_SECONDS=3600
